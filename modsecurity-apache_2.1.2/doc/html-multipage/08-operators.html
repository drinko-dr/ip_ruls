<html><head><META http-equiv="Content-Type" content="text/html; charset=ISO-8859-1"><title>Operators</title><link href="modsecurity-reference.css" rel="stylesheet" type="text/css"><meta content="DocBook XSL Stylesheets V1.69.1" name="generator"><link rel="start" href="index.html" title="ModSecurity Reference Manual"><link rel="up" href="index.html" title="ModSecurity Reference Manual"><link rel="prev" href="07-actions.html" title="Actions"></head><body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF"><div style="background:#F5F5F5;width:100%;border-top:1px solid #DDDDDD;border-bottom:1px solid #DDDDDD"><table width="100%" cellspacing="0" cellpadding="0"><tr><td><a href="http://www.modsecurity.org"><img style="margin:4px" src="modsecurity.gif" width="120" height="36" alt="ModSecurity" border="0"></a></td><td align="right"><a href="http://www.breach.com"><img style="margin:6px" src="breach-logo-small.gif" height="36" width="100" border="0"></a></td></tr></table></div><div id="navheader"><table summary="Navigation header" width="100%"><tr><th align="center" colspan="3">Operators</th></tr><tr><td align="left" width="20%"><a accesskey="p" href="07-actions.html">Prev</a>&nbsp;</td><td align="center" width="60%">&nbsp;<a accesskey="h" href="index.html">Home</a></td><td align="right" width="20%">&nbsp;</td></tr></table><hr size="1"></div><div class="section" lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="08-operators"></a>Operators</h2></div></div><div></div></div><p>A number of operators can be used in rules, as documented below. The
    operator syntax used the "@" symbol followed by the specific operator
    name.</p><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="N11418"></a><code class="literal">eq</code></h3></div></div><div></div></div><p><span class="bold"><strong>Description:</strong></span> This operator is a
      numerical comparison and stands for "equal to."</p><p>Example:</p><pre class="programlisting">SecRule &amp;REQUEST_HEADERS_NAMES "<span class="bold"><strong>@eq</strong></span> 15"</pre></div><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="N1142A"></a><code class="literal">ge</code></h3></div></div><div></div></div><p><span class="bold"><strong>Description:</strong></span> This operator is a
      numerical comparison and stands for "greater than or equal to."</p><p>Example:</p><pre class="programlisting">SecRule &amp;REQUEST_HEADERS_NAMES "<span class="bold"><strong>@ge</strong></span> 15"</pre></div><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="N1143C"></a><code class="literal">gt</code></h3></div></div><div></div></div><p><span class="bold"><strong>Description:</strong></span> This operator is a
      numerical comparison and stands for "greater than."</p><p>Example:</p><pre class="programlisting">SecRule &amp;REQUEST_HEADERS_NAMES "<span class="bold"><strong>@gt</strong></span> 15"</pre></div><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="N1144E"></a><code class="literal">inspectFile</code></h3></div></div><div></div></div><p><span class="bold"><strong>Description:</strong></span> Executes the
      external script/binary given as parameter to the operator against every
      file extracted from the request.</p><p>Example:</p><pre class="programlisting">SecRule FILES_TMPNAMES "<span class="bold"><strong>@inspectFile</strong></span> /opt/apache/bin/inspect_script.pl"</pre></div><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="N11460"></a><code class="literal">le</code></h3></div></div><div></div></div><p><span class="bold"><strong>Description:</strong></span> This operator is a
      numerical comparison and stands for "less than or equal to."</p><p>Example:</p><pre class="programlisting">SecRule &amp;REQUEST_HEADERS_NAMES "<span class="bold"><strong>@le</strong></span> 15"</pre></div><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="N11472"></a><code class="literal">lt</code></h3></div></div><div></div></div><p><span class="bold"><strong>Description:</strong></span> This operator is a
      numerical comparison and stands for "less than."</p><p>Example:</p><pre class="programlisting">SecRule &amp;REQUEST_HEADERS_NAMES "<span class="bold"><strong>@lt </strong></span>15"</pre></div><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="N11484"></a><code class="literal">rbl</code></h3></div></div><div></div></div><p><span class="bold"><strong>Description:</strong></span> Look up the
      parameter in the RBL given as parameter. Parameter can be an IPv4
      address, or a hostname.</p><p>Example:</p><pre class="programlisting">SecRule REMOTE_ADDR "<span class="bold"><strong>@rbl</strong></span> sc.surbl.org"</pre></div><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="N11496"></a><code class="literal">rx</code></h3></div></div><div></div></div><p><span class="bold"><strong>Description:</strong></span> Regular expression
      operator. This is the default operator, so if the "@" operator is not
      defined, it is assumed to be rx.</p><p>Example:</p><pre class="programlisting">SecRule REQUEST_HEADERS:User-Agent "<span class="bold"><strong>@rx</strong></span> nikto"</pre><p><span class="bold"><strong>Note</strong></span></p><p>Regular expressions are handled by the PCRE library (<a href="http://www.pcre.org" target="_top">http://www.pcre.org</a>). ModSecurity
      compiles its regular expressions with the following settings:</p><div class="orderedlist"><ol type="1"><li><p>The entire input is treated as a single line, even when there
          are newline characters present.</p></li><li><p>All matches are case-sensitive. If you do not care about case
          sensitivity you either need to implement the <code class="literal">lowercase</code> transformational function, or
          use the per-pattern<code class="literal">(?i)</code>modificator, as allowed by
          PCRE.</p></li><li><p>The <code class="literal">PCRE_DOTALL</code> and
          <code class="literal">PCRE_DOLLAR_ENDONLY</code> flags are set
          during compilation, meaning a single dot will match any character,
          including the newlines and a <code class="literal">$</code>
          end anchor will not match a trailing newline charater.</p></li></ol></div></div><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="N114D2"></a><code class="literal">validateByteRange</code></h3></div></div><div></div></div><p><span class="bold"><strong>Description:</strong></span> Validates the byte
      range used in the variable falls into the specified range.</p><p>Example:</p><pre class="programlisting">SecRule ARG:text "<span class="bold"><strong>@validateByteRange</strong></span> 10, 13, 32-126"</pre><p><span class="bold"><strong>Note</strong></span></p><p>You can force requests to consist only of bytes from a certain
      byte range. This can be useful to avoid stack overflow attacks (since
      they usually contain "random" binary content). Default range values are
      0 and 255, i.e. all byte values are allowed. This directive does not
      check byte range in a POST payload when multipart/form-data encoding
      (file upload) is used. Doing so would prevent binary files from being
      uploaded. However, after the parameters are extracted from such request
      they are checked for a valid range.</p><p>validateByteRange is similar to the ModSecurity 1.X
      SecFilterForceByteRange Directive however since it works in a rule
      context, it has the following differences:</p><div class="itemizedlist"><ul type="disc"><li><p>You can specify a different range for different
          variables.</p></li><li><p>It has an "event" context (id, msg....)</p></li><li><p>It is executed in the flow of rules rather than being a built
          in pre-check.</p></li></ul></div></div><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="N114F6"></a><code class="literal">validateDTD</code></h3></div></div><div></div></div><p><span class="bold"><strong>Description:</strong></span> This operator
      requires the request body to be processed as XML.</p><p>Example:</p><pre class="programlisting">SecDefaultAction log,deny,status:403,phase:2
SecRule REQUEST_HEADERS:Content-Type ^text/xml$ \
    phase:1,t:lowercase,nolog,pass,ctl:requestBodyProcessor=XML
SecRule REQBODY_PROCESSOR "!^XML$" nolog,pass,skip:1
SecRule XML "<span class="bold"><strong>@validateDTD /path/to/apache2/conf/xml.dtd</strong></span>"</pre></div><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="N11508"></a><code class="literal">validateSchema</code></h3></div></div><div></div></div><p><span class="bold"><strong>Description:</strong></span> This operator
      requires the request body to be processed as XML.</p><p>Example:</p><pre class="programlisting">SecDefaultAction log,deny,status:403,phase:2
SecRule REQUEST_HEADERS:Content-Type ^text/xml$ \
    phase:1,t:lowercase,nolog,pass,ctl:requestBodyProcessor=XML
SecRule REQBODY_PROCESSOR "!^XML$" nolog,pass,skip:1
SecRule XML "<span class="bold"><strong>@validateSchema /path/to/apache2/conf/xml.xsd</strong></span>"</pre><p>This operator requires request body to be processed as XML.</p></div><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="N1151C"></a><code class="literal">validateUrlEncoding</code></h3></div></div><div></div></div><p><span class="bold"><strong>Description:</strong></span> Verifies the
      encodings used in the variable (if any) are valid.</p><p>Example:</p><pre class="programlisting">SecRule ARGS "<span class="bold"><strong>@validateUrlEncoding</strong></span>"</pre><p><span class="bold"><strong>Note</strong></span></p><p>URL encoding is an HTTP standard for encoding byte values within a
      URL. The byte is escaped with a % followed by two hexadecimal values
      (0-F). This directive does not check encoding in a POST payload when the
      multipart/form-data encoding (file upload) is used. It is not necessary
      to do so because URL encoding is not used for this encoding.</p></div><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="N11534"></a><code class="literal">validateUtf8Encoding</code></h3></div></div><div></div></div><p><span class="bold"><strong>Description:</strong></span> Verifies the
      variable is a valid UTF-8 encoded string.</p><p>Example:</p><pre class="programlisting">SecRule ARGS "<span class="bold"><strong>@validateUtf8Encoding</strong></span>"</pre><p><span class="bold"><strong>Note</strong></span></p><p>UTF-8 encoding is valid on most web servers. Integer values
      between 0-65535 are encoded in a UTF-8 byte sequence that is escaped by
      percents. The short form is two bytes in length.</p><p>check for three types of errors:</p><div class="itemizedlist"><ul type="disc"><li><p>Not enough bytes. UTF-8 supports two, three, four, five, and
          six byte encodings. ModSecurity will locate cases when a byte or
          more is missing.</p></li><li><p>Invalid encoding. The two most significant bits in most
          characters are supposed to be fixed to 0x80. Attackers can use this
          to subvert Unicode decoders.</p></li><li><p>Overlong characters. ASCII characters are mapped directly into
          the Unicode space and are thus represented with a single byte.
          However, most ASCII characters can also be encoded with two, three,
          four, five, and six characters thus tricking the decoder into
          thinking that the character is something else (and, presumably,
          avoiding the security check).</p></li></ul></div></div></div><div id="navfooter"><hr size="1"><table summary="Navigation footer" width="100%"><tr><td align="left" width="40%"><a accesskey="p" href="07-actions.html">Prev</a>&nbsp;</td><td align="center" width="20%">&nbsp;</td><td align="right" width="40%">&nbsp;</td></tr><tr><td valign="top" align="left" width="40%">Actions&nbsp;</td><td align="center" width="20%"><a accesskey="h" href="index.html">Home</a></td><td valign="top" align="right" width="40%">&nbsp;</td></tr></table></div><div align="center" class="copyright">Copyright (C) 2004-2006 <a href="http://www.breach.com">Breach Security</a></div></body></html>